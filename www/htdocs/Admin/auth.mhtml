<%doc>
</%doc>
<%args>
	$auth_method       => '';
	$admin_auth_method => '';
</%args>
<%perl>
my ($isRoot, $junk) = $m->comp('/Admin/MemberOf', 'acl' => [ 'Admin' ], 'group' => 'default');
if (!$isRoot) {
	print qq{<p class='error'>Sorry, you don't have access to this form.</P>};
	return;
}
my $WH = "----------------------";
my $aa = $np->cfg->policy(-key => 'ADMIN_AUTH_METHOD');
my $ca = $np->cfg->policy(-key => 'AUTH_METHOD');
</%perl>

<script language='JavaScript'><!--
var pageDirty = false;
setWhereAmI('Authentication &gt; Methods');
--></script>

<TABLE WIDTH=800 ID="authMethods" CELLSPACING=2 CELLPADDING=2>
<THEAD>
<TR><TH COLSPAN=2>Authentication Methods</TH></TR>
</THEAD>
<TBODY>
<TR>
<TD CLASS='left'>Client Auth Method</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name    => 'auth_method',
                        -default => $ca,
                        -values => [ 'NetPass::Auth::DB' , 'NetPass::Auth::Radius',
					'NetPass::Auth::LDAP', 'NetPass::Auth::Unix' ]
                    )%>
</TD></TR>
<TR><TD>
% if ($ca eq "Netpass::Auth::Radius") {
%	$m->comp('/Admin/FormAuthRadius', %ARGS);
% elsif ($ca eq "Netpass::Auth::LDAP") {
%	$m->comp('/Admin/FormAuthLDAP', %ARGS);
% }
</tD></TR>
<TR>
<TD CLASS='left'>Admin Auth Method</TD>
<TD CLASS='right'>
<%$q->popup_menu (
			-name   => 'admin_auth_method',
                        -default => $aa,
                        -values => [ 'NetPass::Auth::DB' , 'NetPass::Auth::Radius',
					'NetPass::Auth::LDAP', 'NetPass::Auth::Unix' ]
                    )%>
</TD></TR>
<TR><TD>
% if ($aa eq "Netpass::Auth::Radius") {
%	$m->comp('/Admin/FormAuthRadius', 'prefix' => 'admin_', %ARGS);
% elsif ($aa eq "Netpass::Auth::LDAP") {
%	$m->comp('/Admin/FormAuthLDAP', 'prefix' => 'admin_', %ARGS);
% }
</tD></TR>
</table>
