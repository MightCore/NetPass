
<%doc>
# $Header: /tmp/netpass/NetPass/www/htdocs/Admin/gencfg.mhtml,v 1.18 2005/06/08 12:12:26 mtbell Exp $

#   (c) 2004 University at Buffalo.
#   Available under the "Artistic License"
#   http://www.gnu.org/licenses/license-list.html#ArtisticLicense

NAME

	General Configuration 

PERMISSIONS

	RO: NONE
	RW: Must be member of default/Admin

</%doc>

<%args>
	$submit => '';
</%args>

<script><!--
setWhereAmI('General Config');
--></script>

<%perl>

my ($isRoot, $groups) = $m->comp('/Admin/MemberOf', 'group' => 'default', 'acl' => [ 'Admin' ]);

if (! $isRoot  ) {
        print $q->p({-class=>'error'}, qq{Sorry, permission denied.<BR>(You must be an Admin for group "default".)});
        return;
}

print $q->start_form(-method => "POST");

</%perl>

<h2>General (Global) Configuration</h2>

<input disabled id='submitButton' type='submit' name='submit' value='Commit Changes'> <P>

% $m->comp('/Admin/LockConfig', 'enableWhenLocked' => 'submitButton');

<%perl>

$m->comp('/Admin/FormNPPolicy', 'submit' => $submit, %ARGS);
$m->comp('/Admin/FormNPNessus', 'submit' => $submit, %ARGS);
$m->comp('/Admin/FormNPSnort',  'submit' => $submit, 'network' => "", %ARGS);
$m->comp('/Admin/FormNPApi',    'submit' => $submit, %ARGS);
$m->comp('/Admin/FormNPDb',     'submit' => $submit, %ARGS);

if ($submit eq 'Commit Changes') {
	$np->cfg->save(-user => $m->session->{'username'});
}

print $q->end_form();
</%perl>

<script language="JavaScript">
/* showHideObj2(document.getElementById("databaseConfig").tBodies[0]);
 showHideObj2(document.getElementById("nessusConfig").tBodies[0]);
 showHideObj2(document.getElementById("policyConfig").tBodies[0]);*/
</script>
