<%doc>
</%doc>
<%args>
	$tableName => 'General';
	$network   => '';
        $suppressKeys => {};
</%args>

<TABLE WIDTH=800 ID="policyConfig" class="expandable" CELLSPACING=2 CELLPADDING=2>
<THEAD>
<TR><TH onclick="showHideObj2(getElementById('policyConfig').tBodies[0]);" COLSPAN=2><%$tableName%></TH></TR>
</THEAD>
<TBODY>
<tr><th>Option</th><th>Value</th><th>Use Default</th><th>Default Value</th></tr>
<TR>
<TD CLASS='left'>MULTI_MAC</TD>
<TD CLASS='right' >

<%$q->popup_menu (
                        -name     => 'policy:MULTI_MAC',
                        -values   => ['ALL_OK', 'ONE_OK', 'DISALLOWED'],
                        -default  => $np->cfg->policy(-key => 'MULTI_MAC', -network => $network),
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'MULTI_MAC', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:MULTI_MAC"></td>
<td class='left'><%$np->cfg->policy(-key => 'MULTI_MAC')%></td>
</TR>
<TR>
<TD CLASS='left'>Strikes</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:STRIKES',
                        -value  => $np->cfg->policy(-key => 'STRIKES', -network => $network),
                        -size   => 3,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'STRIKES', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:STRIKES"></td>
<td class='left'><%$np->cfg->policy(-key => 'STRIKES')%></td>
</TR>
<TR>
<TD CLASS='left'>RESULTS_DISPLAY</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:RESULTS_DISPLAY',
			-values	  => ['INLINE', 'POPUP'],
                        -default  => $np->cfg->policy(-key => 'RESULTS_DISPLAY', -network => $network),
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'RESULTS_DISPLAY', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:RESULTS_DISPLAY"></td>
<td class='left'><%$np->cfg->policy(-key => 'RESULTS_DISPLAY')%></td>
</TR>
<TR>
<TD CLASS='left'>RESULTS_EXPAND</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:RESULTS_EXPAND',
                        -value  => $np->cfg->policy(-key => 'RESULTS_EXPAND', -network => $network),
                        -size   => 3,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'RESULTS_EXPAND', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:RESULTS_EXPAND"></td>
<td class='left'><%$np->cfg->policy(-key => 'RESULTS_EXPAND')%></td>
</TR>
<TR>
<TD CLASS='left'>AUTO_REDIRECT</TD>
<TD CLASS='right'>
<%$q->radio_group (
                        -name    => 'policy:AUTO_REDIRECT',
			-values  => ['Yes', 'No'],
                        -default => ($np->cfg->policy(-key => 'AUTO_REDIRECT', -network => $network)) ? 'Yes' : 'No'
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'AUTO_REDIRECT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:AUTO_REDIRECT"></td>
<td class='left'><%$np->cfg->policy(-key => 'AUTO_REDIRECT')?"Yes":"No"%></td>
</TR>
<TR>
<TD CLASS='left'>COOKIE_DETECT</TD>
<TD CLASS='right'>
<%$q->radio_group (
                        -name    => 'policy:COOKIE_DETECT',
                        -values  => ['Yes', 'No'],
                        -default => ($np->cfg->policy(-key => 'COOKIE_DETECT', -network => $network)) ? 'Yes' : 'No'
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'COOKIE_DETECT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:COOKIE_DETECT"></td>
<td class='left'><%$np->cfg->policy(-key => 'COOKIE_DETECT')?"Yes":"No"%></td>
</TR>
<TR>
<TD CLASS='left'>COOKIE_NAME</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:COOKIE_NAME',
                        -value  => $np->cfg->policy(-key => 'COOKIE_NAME', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'COOKIE_NAME', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:COOKIE_NAME"></td>
<td class='left'><%$np->cfg->policy(-key => 'COOKIE_NAME')%></td>
</TR>
<TR>
<TD CLASS='left'>REDIR_URL_DEFAULT</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:REDIR_URL_DEFAULT',
                        -value  => $np->cfg->policy(-key => 'REDIR_URL_DEFAULT', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'REDIR_URL_DEFAULT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:REDIR_URL_DEFAULT"></td>
<td class='left'><%$np->cfg->policy(-key => 'REDIR_URL_DEFAULT')%></td>
</TR>
<TR>
<TD CLASS='left'>SURVEY_ENABLED</TD>
<TD CLASS='right'>
<%$q->radio_group (
                        -name    => 'policy:SURVEY_ENABLED',
                        -values  => ['Yes', 'No'],
                        -default => ($np->cfg->policy(-key => 'SURVEY_ENABLED', -network => $network)) ? 'Yes' : 'No'
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'SURVEY_ENABLED', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:SURVEY_ENABLED"></td>
<td class='left'><%$np->cfg->policy(-key => 'SURVEY_ENABLED')?"Yes":"No"%></td>
</TR>
<TR>
<TD CLASS='left'>SURVEY_EMAIL</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:SURVEY_EMAIL',
                        -value  => $np->cfg->policy(-key => 'SURVEY_EMAIL', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'SURVEY_EMAIL', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:SURVEY_EMAIL"></td>
<td class='left'><%$np->cfg->policy(-key => 'SURVEY_EMAIL')%></td>
</TR>

% if (!exists $suppressKeys->{'PID_DIR'}) {
<TR>
<TD CLASS='left'>PID_DIR</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:PID_DIR',
                        -value  => $np->cfg->policy(-key => 'PID_DIR', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'PID_DIR', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:PID_DIR"></td>
<td class='left'><%$np->cfg->policy(-key => 'PID_DIR')%></td>
</TR>
%}

% if (!exists $suppressKeys->{'BASE_DIR'}) {
<TR>
<TD CLASS='left'>BASE_DIR</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:BASE_DIR',
                        -value  => $np->cfg->policy(-key => 'BASE_DIR', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'BASE_DIR', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:BASE_DIR"></td>
<td class='left'><%$np->cfg->policy(-key => 'BASE_DIR')%></td>
</TR>
%}

<TR>
<TD CLASS='left'>PORT_SEARCH_ALGO</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:PORT_SEARCH_ALGO',
                        -values   => ['LINEAR', 'TREE'],
                        -default  => $np->cfg->policy(-key => 'PORT_SEARCH_ALGO', -network => $network),
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'PORT_SEARCH_ALGO', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:PORT_SEARCH_ALGO"></td>
<td class='left'><%$np->cfg->policy(-key => 'PORT_SEARCH_ALGO')%></td>
</TR>
<TR>
<TD CLASS='left'>PORT_CACHE</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:PORT_CACHE',
                        -values   => ['ON', 'OFF'],
                        -default  => ($np->cfg->policy(-key => 'PORT_CACHE', -network => $network)) ? 'ON' : 'OFF',
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'PORT_CACHE', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:PORT_CACHE"></td>
<td class='left'><%$np->cfg->policy(-key => 'PORT_CACHE')?"on":"off"%></td>
</TR>
<TR>
<TD CLASS='left'>UNQUAR_ON_LINKUP</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:UNQUAR_ON_LINKUP',
                        -values   => ['ON', 'OFF', 'ITDEPENDS'],
                        -default  => ($np->cfg->policy(-key => 'UNQUAR_ON_LINKUP', -network => $network) eq
				     'ITDEPENDS') ? 'ITDEPENDS' : 
				     ($np->cfg->policy(-key => 'UNQUAR_ON_LINKUP', -network => $network)) ? 
				     'ON' : 'OFF',
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'UNQUAR_ON_LINKUP', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:UNQUAR_ON_LINKUP"></td>
% my $uqlu = $np->cfg->policy(-key => 'UNQUAR_ON_LINKUP');
% $uqlu = ($uqlu =~ /itdepends/i)?$uqlu : ($uqlu ? "on" : "off");
<td class='left'><%$uqlu%></td>
</TR>
<TR>
<TD CLASS='left'>Enable ResetPort?</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:resetport',
                        -values   => ['on', 'off'],
                        -default  => ($np->cfg->policy(-key => 'resetport', -network => $network)) ? 'on': 'off',
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'resetport', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:resetport"></td>
<td class='left'><%$np->cfg->policy(-key => 'resetport')?"on":"off"%></td>
</TR>
<TR>
<TD CLASS='left'>Enable MacScan?</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:macscan',
                        -values   => ['on', 'off'],
                        -default  => ($np->cfg->policy(-key => 'macscan', -network => $network)) ? 'on': 'off',
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'macscan', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:macscan"></td>
<td class='left'><%$np->cfg->policy(-key => 'macscan')?"on":"off"%></td>
</TR>
<TR>
<TD CLASS='left'>Require Nessus to register?</TD>
<TD CLASS='right'>
<%$q->popup_menu (
                        -name     => 'policy:nessus',
                        -values   => ['on', 'off'],
                        -default  => ($np->cfg->policy(-key => 'resetport', -network => $network)) ? 'on': 'off',
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'resetport', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:resetport"></td>
<td class='left'><%$np->cfg->policy(-key => 'resetport')?"on":"off"%></td>
</TR>
<TR>
<TD CLASS='left'>LDAP Query URL</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:LDAP_USER_QUERY',
                        -value  => $np->cfg->policy(-key => 'LDAP_USER_QUERY', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'LDAP_USER_QUERY', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:LDAP_USER_QUERY"></td>
<td class='left'><%$np->cfg->policy(-key => 'LDAP_USER_QUERY')%></td>
</TR>
<TR>
<TD CLASS='left'>LDAP Popup Width</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:LDAP_POPUP_WIDTH',
                        -value  => $np->cfg->policy(-key => 'LDAP_POPUP_WIDTH', -network => $network),
                        -size   => 5,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'LDAP_POPUP_WIDTH', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:LDAP_POPUP_WIDTH"></td>
<td class='left'><%$np->cfg->policy(-key => 'LDAP_POPUP_WIDTH')%></td>
</TR>
<TR>
<TD CLASS='left'>LDAP Popup Height</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:LDAP_POPUP_HEIGHT',
                        -value  => $np->cfg->policy(-key => 'LDAP_POPUP_HEIGHT', -network => $network),
                        -size   => 5,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'LDAP_POPUP_HEIGHT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:LDAP_POPUP_HEIGHT"></td>
<td class='left'><%$np->cfg->policy(-key => 'LDAP_POPUP_HEIGHT')%></td>
</TR>
<TR>
<TD CLASS='left'>Username Prompt</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:USERNAME_PROMPT',
                        -value  => $np->cfg->policy(-key => 'USERNAME_PROMPT', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'USERNAME_PROMPT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:USERNAME_PROMPT"></td>
<td class='left'><%$np->cfg->policy(-key => 'USERNAME_PROMPT')%></td>
</TR>
<TR>
<TD CLASS='left'>Password Prompt</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:PASSWORD_PROMPT',
                        -value  => $np->cfg->policy(-key => 'PASSWORD_PROMPT', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'PASSWORD_PROMPT', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:PASSWORD_PROMPT"></td>
<td class='left'><%$np->cfg->policy(-key => 'PASSWORD_PROMPT')%></td>
</TR>
<TR>
<TD CLASS='left'>Company Name</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:COMPANY_NAME',
                        -value  => $np->cfg->policy(-key => 'COMPANY_NAME', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'COMPANY_NAME', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:COMPANY_NAME"></td>
<td class='left'><%$np->cfg->policy(-key => 'COMPANY_NAME')%></td>
</TR>
<TR>
<TD CLASS='left'>Company Abbreviation</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:COMPANY_SHORT_NAME',
                        -value  => $np->cfg->policy(-key => 'COMPANY_SHORT_NAME', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'COMPANY_SHORT_NAME', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:COMPANY_SHORT_NAME"></td>
<td class='left'><%$np->cfg->policy(-key => 'COMPANY_SHORT_NAME')%></td>
</TR>
<TR>
<TD CLASS='left'>Organization Name</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:COMPANY_UNIT_NAME',
                        -value  => $np->cfg->policy(-key => 'COMPANY_UNIT_NAME', -network => $network),
                        -size   => 25,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'COMPANY_UNIT_NAME', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:COMPANY_UNIT_NAME"></td>
<td class='left'><%$np->cfg->policy(-key => 'COMPANY_UNIT_NAME')%></td>
</TR>
<TR>
<TD CLASS='left'>Example IP Address</TD>
<TD CLASS='right'>
<%$q->textfield (
                        -name   => 'policy:EXAMPLE_IPADDR',
                        -value  => $np->cfg->policy(-key => 'EXAMPLE_IPADDR', -network => $network),
                        -size   => 16,
                    )%>
</TD>
<td class='left'><input type='checkbox' <%$np->cfg->policyLocation(-key => 'EXAMPLE_IPADDR', -network => $network, -location => 'group')?"":"checked"%> name="usedefault:EXAMPLE_IPADDR"></td>
<td class='left'><%$np->cfg->policy(-key => 'EXAMPLE_IPADDR')%></td>
</TR>

</TBODY></TABLE>
