<%doc>
</%doc>
<%args>
        $submit         => '';
</%args>

<%perl>
my $restartnetpass  = 0;

if ($submit eq 'Commit Changes') {
	foreach my $ak ( keys %ARGS ) {
		if ($ak =~ /^(\S+):(\S+)$/) {
			my $section = $1;
			my $var     = $2;

			if ($section eq "database") {
				my $db  = "database";
				if (!$np->cfg->{'cfg'}->exists('database')) {
					$np->cfg->{'cfg'}->$db({});	
				}
				$np->cfg->{'cfg'}->obj('database')->$var($ARGS{$ak});
				$restartnetpass = 1;
			}
		}
	}

	$np->db->reqAppAction('netpass', 'restart', '') if ($restartnetpass);
}
</%perl>

<TABLE WIDTH=800 CLASS="expandable" ID="databaseConfig" CELLSPACING=2 CELLPADDING=2>
<THEAD>
<TR><TH ONCLICK="showHideObj2(getElementById('databaseConfig').tBodies[0]);" COLSPAN=2>Database</TH></TR>
</THEAD>
<TBODY>
<%perl>


foreach my $d (sort $np->cfg->{'cfg'}->keys('database')) {
        print "<TR>";
        print "<TD CLASS='left'>$d</TD>";
        print "<TD CLASS='right'>";
        print $q->textfield (
                                -name   => "database:$d",
				-value  => $np->cfg->{'cfg'}->obj('database')->value($d),
				-size 	=> 25 ,
                            );
        print "</TD></TR>";
}
print "</TBODY></TABLE>";

print $q->end_form();
</%perl>
